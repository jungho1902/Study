# 순기구학 (Forward Kinematics)

**순기구학(Forward Kinematics)**은 로봇의 각 관절(Joint)의 각도나 변위를 알 때, 이를 바탕으로 로봇의 끝점(End-Effector)의 위치(Position)와 방향(Orientation)을 계산하는 문제입니다. 즉, 관절 공간(Joint Space)에서 직교 좌표 공간(Cartesian Space)으로의 변환을 의미합니다.

- **입력:** 로봇의 각 관절 값 (예: θ₁, θ₂, d₃, ...)
- **출력:** 로봇 엔드 이펙터의 3차원 위치 (x, y, z)와 방향 (Roll, Pitch, Yaw)

순기구학은 로봇의 현재 상태를 파악하고, 로봇이 어디에 있는지, 어떤 자세를 취하고 있는지를 아는 데 필수적입니다.

## 순기구학 계산 방법

순기구학은 **동차 변환 행렬(Homogeneous Transformation Matrix)**의 연쇄적인 곱으로 계산됩니다. 로봇의 베이스 좌표계부터 엔드 이펙터 좌표계까지, 각 링크(Link)와 관절(Joint)을 거치면서 발생하는 좌표계 변환을 순서대로 곱해 나갑니다.

예를 들어, 3개의 관절을 가진 로봇 팔이 있다면, 엔드 이펙터의 변환 행렬 `T_e`는 다음과 같이 계산됩니다.

`T_e = T_base_to_1 * T_1_to_2 * T_2_to_3 * T_3_to_e`

여기서 `T_i_to_j`는 좌표계 {i}에서 좌표계 {j}로의 동차 변환 행렬을 의미합니다.

이러한 변환 관계를 체계적으로 정의하기 위해 **Denavit-Hartenberg (DH) 파라미터**라는 표준화된 방법이 널리 사용됩니다.

## Denavit-Hartenberg (DH) 파라미터

DH 파라미터는 로봇의 인접한 두 링크 사이의 기하학적 관계를 4개의 파라미터로 정의하는 방법입니다. 이를 통해 각 관절에 대한 변환 행렬을 표준화된 방식으로 유도할 수 있어 계산이 용이해집니다.

각 링크 `i`와 관절 `i`에 대해, 좌표계 {i-1}에서 {i}로의 변환은 다음 4개의 파라미터로 정의됩니다.

1.  **Link Length (`aᵢ₋₁`):** Zᵢ₋₁ 축과 Zᵢ 축 사이의 공통 수선의 길이. (Zᵢ₋₁과 Zᵢ가 평행하면, 두 축을 잇는 선분의 길이)
2.  **Link Twist (`αᵢ₋₁`):** Zᵢ₋₁ 축에서 Zᵢ 축까지 Xᵢ₋₁ 축을 기준으로 회전한 각도.
3.  **Link Offset (`dᵢ`):** Xᵢ₋₁ 축과 Xᵢ 축 사이의 Zᵢ 축을 따른 거리. (직동 관절의 경우 변수)
4.  **Joint Angle (`θᵢ`):** Xᵢ₋₁ 축에서 Xᵢ 축까지 Zᵢ 축을 기준으로 회전한 각도. (회전 관절의 경우 변수)

![DH Parameters](https://upload.wikimedia.org/wikipedia/commons/thumb/a/a2/Denavit-Hartenberg_parameters.svg/500px-Denavit-Hartenberg_parameters.svg.png)

### DH 파라미터를 이용한 변환 행렬

이 4개의 파라미터를 사용하여 좌표계 {i-1}에서 {i}로의 변환 행렬 `T_i-1_to_i`는 다음과 같이 4개의 기본 변환(회전과 이동)의 곱으로 표현됩니다.

`T_i-1_to_i = Rot(Z, θᵢ) * Trans(Z, dᵢ) * Trans(X, aᵢ₋₁) * Rot(X, αᵢ₋₁)`

이를 행렬로 나타내면 다음과 같습니다.

```
| cos(θᵢ)  -sin(θᵢ)cos(αᵢ₋₁)   sin(θᵢ)sin(αᵢ₋₁)   aᵢ₋₁cos(θᵢ) |
| sin(θᵢ)   cos(θᵢ)cos(αᵢ₋₁)  -cos(θᵢ)sin(αᵢ₋₁)   aᵢ₋₁sin(θᵢ) |
|    0         sin(αᵢ₋₁)          cos(αᵢ₋₁)          dᵢ      |
|    0            0                  0               1       |
```

로봇의 모든 관절에 대해 DH 파라미터 테이블을 작성하고, 각 관절의 변환 행렬을 계산한 뒤, 이를 베이스부터 순서대로 모두 곱하면 최종적으로 엔드 이펙터의 위치와 방향을 나타내는 변환 행렬을 얻을 수 있습니다.

`T_end_effector = T_0_1 * T_1_2 * ... * T_n-1_n`

이것이 DH 파라미터를 이용한 순기구학의 핵심 원리입니다.
