# 파트 10: AI 기반 로봇 응용 (AI-Powered Robotic Applications)

## 10.4. 휴머노이드 및 다리 로봇 (Humanoids and Legged Robots)

### 10.4.2. 전신 동역학 및 제어 (Whole-Body Dynamics and Control)

**들어가며**

휴머노이드 로봇이 단순히 걷는 것을 넘어, 문을 열거나, 물건을 옮기거나, 다른 작업을 동시에 수행하려면 어떻게 해야 할까요? 로봇 팔로 문고리를 잡고 돌리는 순간, 그 힘은 로봇의 상체, 허리, 다리, 발바닥까지 영향을 미칩니다. 이처럼 로봇의 모든 부분이 서로 연결되어 영향을 주고받는 복잡한 시스템을 효과적으로 제어하는 기술이 바로 **전신 제어(Whole-Body Control)**입니다. 이는 로봇의 모든 관절과 링크(link)를 하나의 통합된 시스템으로 보고, 주어진 임무를 수행하면서 동시에 균형을 유지하도록 최적의 관절 움직임을 실시간으로 계산하는 문제입니다.

---

**1. 왜 전신 제어가 필요한가?**

- **다중 작업 동시 수행:** 걷는 동시에 팔을 흔들거나, 물건을 든 채로 계단을 오르는 등 여러 작업을 동시에 안정적으로 수행하기 위해 필요합니다.
- **동적 상호작용:** 문을 밀거나, 땅을 딛는 것처럼 외부 환경과 힘을 주고받는 작업을 수행할 때, 그 반작용이 로봇 전체에 미치는 영향을 고려하여 균형을 유지해야 합니다.
- **여유 자유도(Redundancy) 활용:** 휴머노이드는 보통 작업에 필요한 최소한의 자유도(DoF)보다 훨씬 많은 수의 관절(여유 자유도)을 가지고 있습니다. 예를 들어, 손의 위치와 방향(6-DoF)을 고정한 상태에서도 팔꿈치나 어깨, 허리를 움직여 다양한 자세를 만들 수 있습니다. 전신 제어는 이러한 여유 자유도를 적극적으로 활용하여, 주된 임무를 수행하면서 동시에 보조적인 목표(예: 균형 유지, 에너지 소비 최소화, 충돌 회피)를 달성합니다.

---

**2. 전신 동역학 모델 (Whole-Body Dynamics Model)**

전신 제어를 위해서는 로봇 전체의 움직임을 기술하는 동역학 모델이 필요합니다.

- **부동 기저 동역학 (Floating-base Dynamics):**
  - **개념:** 지상 로봇 팔(Fixed-base)과 달리, 휴머노이드나 다리 로봇은 몸통(base)이 공중에 떠서 자유롭게 움직일 수 있습니다. 이를 '부동 기저(Floating Base)'라고 하며, 이 몸통의 6-DoF(x,y,z 위치 및 roll,pitch,yaw 회전)를 로봇의 관절 변수와 함께 고려해야 합니다.
  - **방정식:** 로봇의 동역학 방정식은 일반적으로 다음과 같은 형태로 표현됩니다.
    $`M(q) \ddot{q} + C(q, \dot{q}) = \tau + J^T(q) F_{ext}`$
    - $`q`$: 로봇의 일반화 좌표 (몸통의 6-DoF + 모든 관절의 각도)
    - $`M(q)`$: 관성 행렬 (Inertia Matrix)
    - $`C(q, \dot{q})`$: 코리올리 힘, 원심력, 중력 항
    - $`\tau`$: 각 관절에 가해지는 토크 (제어 입력)
    - $`F_{ext}`$: 발바닥 등에서 외부 환경과 주고받는 힘 (외력)
    - $`J`$: 자코비안 행렬 (Jacobian Matrix)

이 방정식은 '로봇의 모든 관절과 몸통이 어떻게 상호작용하며 움직이는가'를 수학적으로 기술합니다.

---

**3. 전신 제어 기법**

전신 제어의 핵심은 주어진 여러 작업을 동시에 만족시키는 최적의 관절 토크($`\tau`$)를 찾는 것입니다.

- **계층적 제어 (Hierarchical Control / Task-space Control):**
  - **개념:** 수행해야 할 여러 작업에 **우선순위(Priority)**를 부여하고, 우선순위가 높은 작업부터 순서대로 만족시키는 방식으로 제어 입력을 계산합니다.
  - **동작 원리 (Null-space Projection):**
    1.  **가장 높은 우선순위 작업 (Priority 1):** 예를 들어, '균형 유지(ZMP 제어)'나 '발바닥을 땅에 고정하기'와 같은 절대적인 작업을 설정합니다. 이 작업을 수행하기 위한 관절 토크($`\tau_1`$)를 먼저 계산합니다.
    2.  **다음 순위 작업 (Priority 2):** 이제, 첫 번째 작업을 방해하지 않는 '여유 공간(Null-space)' 내에서 두 번째 작업(예: '손을 목표 위치로 이동')을 수행하는 토크($`\tau_2`$)를 계산합니다. 즉, $`\tau_2`$는 $`\tau_1`$의 목표 달성에 아무런 영향을 주지 않는 움직임만을 만들어냅니다.
    3.  **최종 제어 입력:** $`\tau = \tau_1 + \tau_2 + ...`$ 와 같이 각 우선순위별 토크를 합하여 최종 제어 입력을 결정합니다.
  - **장점:** 여러 작업을 체계적으로 조합할 수 있으며, 어떤 작업을 우선시할지 명확하게 설정할 수 있습니다.

- **최적화 기반 제어 (Optimization-based Control):**
  - **개념:** 로봇이 수행해야 할 모든 작업과 제약 조건을 하나의 **최적화 문제**로 정의하고, 이를 만족하는 해(관절 토크 및 가속도)를 실시간으로 찾는 방식입니다.
  - **기술:** 주로 **이차 계획법(Quadratic Programming, QP)**을 사용합니다.
    - **목적 함수 (Objective Function):** 최소화하려는 목표를 설정합니다. (예: `(실제 작업 가속도 - 목표 작업 가속도)`의 제곱 합)
    - **등식 제약 조건 (Equality Constraints):** 반드시 만족해야 하는 물리 법칙을 설정합니다. (예: 로봇의 동역학 방정식)
    - **부등식 제약 조건 (Inequality Constraints):** 만족해야 하는 한계 조건을 설정합니다. (예: `관절 토크 한계`, `마찰력 조건`, `ZMP 안정성 조건`)
  - **장점:** 계층적 제어보다 더 일반적이고 유연한 방식으로 여러 작업을 동시에 다룰 수 있습니다. 물리적 제약 조건을 명시적으로 포함할 수 있어 더 안정적인 제어가 가능합니다.
  - **단점:** 실시간으로 최적화 문제를 풀어야 하므로 높은 계산 성능이 요구됩니다.

**결론**

전신 제어는 휴머노이드 로봇의 '지능적인 몸놀림'을 구현하는 핵심 기술입니다. 로봇의 모든 부분을 하나의 유기적인 시스템으로 보고, 계층적 제어나 최적화 기법을 통해 복잡한 움직임을 실시간으로 생성함으로써 로봇은 비로소 불안정한 두 발로 서서 균형을 잡고, 외부 환경과 상호작용하며 의미 있는 작업을 수행할 수 있게 됩니다. 이는 단순한 보행을 넘어, 인간과 같은 공간에서 인간을 돕는 진정한 '인간형' 로봇으로 나아가는 필수적인 단계입니다.
