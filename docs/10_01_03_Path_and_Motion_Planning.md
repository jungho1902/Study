# 파트 10: AI 기반 로봇 응용 (AI-Powered Robotic Applications)

## 10.1. 자율 이동 로봇 (Autonomous Mobile Robots, AMR) & 자율주행

### 10.1.3. 경로 및 모션 계획 (Path & Motion Planning)

**들어가며**

로봇이 자신의 위치를 알고(Localization) 주변 환경에 대한 지도(Map)를 갖게 되면, 다음 질문은 "어떻게 목표 지점까지 갈 것인가?"가 됩니다. **경로/모션 계획(Path/Motion Planning)**은 출발점에서 목표점까지 장애물을 피하면서 안전하고 효율적인 움직임을 생성하는 과정입니다. 이는 단순히 두 점을 잇는 기하학적 **경로(Path)**를 찾는 것을 넘어, 로봇의 기구학적/동역학적 제약(예: 최소 회전 반경, 가속/감속 능력)과 시간까지 고려한 **궤적(Trajectory)**을 생성하는 복잡한 문제입니다.

- **경로(Path) vs 궤적(Trajectory):**
  - **경로:** 공간상에 있는 점들의 연속. (어디로 갈 것인가?)
  - **궤적:** 시간에 따라 정의된 경로. 각 지점을 언제, 어떤 속도로 지날지에 대한 정보가 포함됨. (어떻게 갈 것인가?)

경로 계획은 보통 계층적으로 나뉩니다.
- **전역 경로 계획 (Global Path Planning):** 전체 지도를 바탕으로 출발점에서 목적지까지의 이상적인 전체 경로를 찾습니다.
- **지역 경로 계획 (Local Path Planning):** 로봇 주변의 지역적인 환경 정보와 센서 데이터를 이용해, 시시각각 변하는 상황(예: 갑자기 나타난 장애물)에 대응하며 전역 경로를 따라가는 실제 주행 궤적을 실시간으로 생성합니다.

---

**1. 전역 경로 계획 (Global Path Planning)**

전역 경로 계획은 정적인 지도 정보가 주어졌을 때 최적의 경로를 탐색하는 데 중점을 둡니다.

- **다익스트라 알고리즘 (Dijkstra's Algorithm):**
  - **개념:** 그래프에서 한 노드(출발점)에서 다른 모든 노드까지의 **최단 경로**를 찾는 알고리즘입니다.
  - **동작:** 출발점에서부터 거리가 가까운 노드들을 순차적으로 탐색하며, 각 노드까지의 최단 거리를 갱신해 나갑니다. 항상 가장 비용(거리)이 적은 경로를 선택합니다.
  - **장점:** 최단 경로를 보장합니다.
  - **단점:** 목표점의 방향과 상관없이 모든 방향으로 탐색을 확장하므로 비효율적일 수 있습니다.

- **A* (에이스타) 알고리즘 (A* Algorithm):**
  - **개념:** 다익스트라 알고리즘을 개선하여, **목표점까지의 예상 거리(Heuristic)** 정보를 추가로 활용하는 '정보 기반 탐색(Informed Search)' 알고리즘입니다.
  - **동작:** 경로를 평가할 때 다음 두 가지 비용의 합을 사용합니다:
    - **g(n):** 출발점부터 현재 노드까지의 실제 누적 비용 (다익스트라와 동일)
    - **h(n):** 현재 노드부터 목표점까지의 추정 비용 (Heuristic). (예: 유클리드 거리)
    - **f(n) = g(n) + h(n)**
    이 f(n) 값이 가장 작은 노드를 우선적으로 탐색하므로, 목표점 방향으로 효율적인 탐색이 가능합니다.
  - **장점:** 다익스트라보다 훨씬 빠르면서도, 휴리스틱 함수 h(n)이 실제 비용보다 항상 작거나 같게 추정한다면(**Admissible Heuristic**), 최단 경로를 보장합니다. 자율 이동 로봇의 전역 경로 계획에 가장 널리 사용됩니다.

> **💡 개념: 설정 공간 (Configuration Space, C-Space)**
> 경로 계획 문제는 로봇 자체의 크기와 형태를 고려해야 해서 복잡합니다. C-Space는 로봇을 하나의 점(Point)으로 단순화하고, 대신 로봇의 크기만큼 주변 장애물을 '팽창(expand)'시키는 가상의 공간입니다. 이 공간에서 점으로 표현된 로봇의 경로를 찾는 것은 원래 공간에서 로봇의 경로를 찾는 것과 동일한 해가 되므로, 문제를 훨씬 쉽게 만들어 줍니다.

---

**2. 지역 경로 계획 (Local Path Planning)**

지역 경로 계획은 실시간 센서 데이터를 기반으로 동적인 장애물을 회피하고 로봇의 실제 움직임을 제어하는 데 초점을 맞춥니다.

- **DWA (Dynamic Window Approach):**
  - **개념:** 로봇의 동역학(속도, 가속도)을 고려하여, 현재 상태에서 **단기간 내에 도달 가능한 속도(선속도, 각속도)의 범위(Dynamic Window)** 내에서 다수의 후보 궤적을 시뮬레이션하고 최적의 궤적을 선택하는 방식입니다.
  - **장점:** 계산이 비교적 간단하고, 동적인 장애물에 대해 매우 반응적으로 회피 기동을 생성할 수 있습니다.
  - **단점:** 단기적인 시뮬레이션에 기반하므로, 좁은 통로나 복잡한 구조에서 최적 경로를 찾지 못하고 지역 최적해(local minima)에 빠질 수 있습니다.

- **TEB (Timed Elastic Band):**
  - **개념:** 전역 경로를 **신축성 있는 밴드(Elastic Band)**처럼 생각하고, 이 밴드를 장애물과 로봇 제약 조건에 맞춰 실시간으로 최적화하여 지역 경로를 생성합니다.
  - **장점:** 전역 경로의 형태를 최대한 유지하려 하므로 DWA보다 안정적이고 부드러운 경로를 생성합니다. 경로의 시간 정보까지 최적화 가능합니다.
  - **단점:** DWA에 비해 계산량이 많고, 파라미터 튜닝이 더 복잡할 수 있습니다.

---

**3. 샘플링 기반 계획 (Sampling-based Planning)**

고차원 공간(예: 다관절 로봇 팔)이나 복잡한 환경에서는 기존 탐색 방식의 계산량이 너무 커집니다. 샘플링 기반 방식은 전체 공간을 탐색하는 대신, 무작위로 샘플링한 점들을 연결하여 경로를 효율적으로 찾습니다.

- **RRT (Rapidly-exploring Random Tree):**
  - **개념:** 출발점에서부터 시작하여, 탐색 공간에 무작위로 점(샘플)을 찍고 그 점 방향으로 기존 트리(Tree)를 확장해 나가는 방식으로 경로를 빠르게 탐색합니다.
  - **동작:**
    1. 출발점을 루트로 하는 트리를 시작합니다.
    2. 공간 내에 무작위 샘플을 생성합니다.
    3. 트리에서 그 샘플과 가장 가까운 노드를 찾아, 샘플 방향으로 일정 거리만큼 트리를 성장시킵니다. (단, 장애물과 충돌하지 않아야 함)
    4. 이 과정을 반복하여 트리를 확장하다가, 목표점 근처에 도달하면 경로가 생성됩니다.
  - **장점:** 복잡하고 고차원적인 공간에서도 매우 빠르게 경로를 찾을 수 있습니다.
  - **단점:** 생성된 경로가 최적 경로라고 보장할 수 없습니다. (경로가 비효율적이고 구불구불할 수 있음)

- **RRT* (RRT Star):**
  - **개념:** RRT의 단점을 보완하여, **경로의 최적성(optimality)**을 점진적으로 개선하는 알고리즘입니다.
  - **동작:** RRT의 기본 골격은 유지하되, 새로운 노드를 트리에 추가할 때 주변 노드들을 탐색하여 더 짧은 경로를 만들 수 있는지 확인하고 **트리 구조를 재연결(rewire)**하는 과정이 추가됩니다. 이를 통해 시간이 지남에 따라 경로가 점차 최적 경로에 수렴하게 됩니다.
  - **장점:** RRT의 빠른 탐색 능력을 유지하면서 점근적으로 최적 경로를 찾을 수 있습니다.
  - **단점:** RRT보다 계산량이 많습니다.

**결론**

경로 계획은 로봇이 지능적으로 움직이기 위한 필수적인 과정입니다. A*와 같은 전역 경로 계획으로 전체적인 길을 찾고, DWA나 TEB와 같은 지역 경로 계획으로 실시간 변화에 대응하며, RRT와 같은 샘플링 기반 계획으로 복잡한 공간을 해결함으로써 로봇은 비로소 복잡한 현실 세계에서 자율적으로 움직일 수 있게 됩니다.
