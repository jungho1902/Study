# CNN의 핵심 구성요소

합성곱 신경망(Convolutional Neural Network, CNN)은 주로 이미지 및 비디오와 같은 그리드(grid) 형태의 데이터를 처리하는 데 특화된 딥러닝 모델입니다. CNN은 인간의 시신경 구조를 모방하여, 데이터의 공간적인 특징(spatial feature)을 효과적으로 추출하고 학습합니다.

CNN의 핵심 구성요소는 **합성곱 레이어(Convolutional Layer)**와 **풀링 레이어(Pooling Layer)**입니다.

---

## 1. 합성곱 레이어 (Convolutional Layer)

합성곱 레이어는 CNN의 가장 중요한 부분으로, 입력 데이터로부터 특징을 추출하는 역할을 합니다. 이는 **필터(Filter)** 또는 **커널(Kernel)**이라고 불리는 작은 행렬을 사용하여 입력 데이터를 순회하며 **합성곱(Convolution)** 연산을 수행함으로써 이루어집니다.

### 1.1. 주요 개념

- **필터 (Filter) / 커널 (Kernel):**
  - 이미지의 특정 특징(예: 수직선, 수평선, 특정 색상, 질감 등)을 감지하기 위한 작은 크기의 가중치 행렬입니다.
  - 예를 들어, 3x3 크기의 필터는 입력 이미지의 3x3 영역을 순회하며 연산을 수행합니다.
  - 필터의 가중치는 학습을 통해 자동으로 최적화됩니다.

- **특징 맵 (Feature Map):**
  - 하나의 필터가 입력 데이터 전체를 순회하며 합성곱 연산을 수행한 결과물입니다.
  - 즉, 특정 특징이 이미지의 어느 위치에서 활성화되는지를 나타내는 맵입니다.
  - 하나의 합성곱 레이어는 여러 개의 필터를 가질 수 있으며, 각 필터는 서로 다른 특징을 추출하여 여러 개의 특징 맵을 생성합니다.

- **스트라이드 (Stride):**
  - 필터가 입력 데이터를 순회할 때 한 번에 이동하는 간격(칸 수)을 의미합니다.
  - Stride가 1이면 필터는 한 픽셀씩 이동하고, 2이면 두 픽셀씩 이동합니다.
  - Stride가 크면 출력 특징 맵의 크기는 작아집니다.

- **패딩 (Padding):**
  - 합성곱 연산을 수행하기 전에 입력 데이터의 가장자리에 특정 값(보통 0)으로 채워진 픽셀을 추가하는 것입니다.
  - **목적:**
    1.  **가장자리 정보 손실 방지:** 패딩이 없으면 필터가 중앙부의 픽셀들보다 가장자리 픽셀들을 덜 방문하게 되어 정보 손실이 발생합니다.
    2.  **출력 크기 조절:** 패딩을 사용하여 합성곱 연산 후에도 입력 데이터와 동일한 공간적 크기를 갖는 특징 맵을 생성할 수 있습니다 ('Same' 패딩).

---

## 2. 풀링 레이어 (Pooling Layer)

풀링 레이어는 합성곱 레이어에서 추출된 특징 맵의 크기를 줄여(Downsampling), 계산량을 감소시키고 모델의 일반화 성능을 높이는 역할을 합니다.

- **주요 목적:**
  - **계산 효율성:** 특징 맵의 크기를 줄여 연산량을 감소시킵니다.
  - **과대적합 방지:** 파라미터 수를 줄이고, 입력의 작은 변화에 덜 민감하게 만들어(translation invariance) 모델의 일반화 성능을 높입니다.

### 2.1. 주요 풀링 방법

- **최대 풀링 (Max Pooling):**
  - 가장 널리 사용되는 풀링 방법입니다.
  - 특징 맵의 특정 영역(예: 2x2)에서 **가장 큰 값(최댓값)**만을 추출합니다.
  - 이는 해당 영역에서 가장 두드러진 특징을 보존하는 효과가 있습니다.

- **평균 풀링 (Average Pooling):**
  - 특징 맵의 특정 영역에 있는 모든 값의 **평균**을 계산하여 추출합니다.
  - 최대 풀링에 비해 특징을 부드럽게 만드는 효과가 있으며, 모든 정보를 종합적으로 고려합니다.

**동작 예시 (2x2 Max Pooling, Stride=2):**
```
  [ 4  2 | 1  8 ]      [ 4 | 8 ]
  [ 3  1 | 5  6 ]      [   |   ]
  -----------------  ->  -----------
  [ 9  1 | 2  2 ]      [ 9 | 7 ]
  [ 0  1 | 3  7 ]      [   |   ]
```
각 2x2 영역에서 가장 큰 값(4, 8, 9, 7)만을 남겨 특징 맵의 크기가 4x4에서 2x2로 줄어들었습니다.

## 3. 일반적인 CNN 구조

일반적으로 CNN은 **[합성곱 레이어 -> 활성화 함수(ReLU) -> 풀링 레이어]**의 블록을 여러 겹으로 쌓은 후, 마지막에 완전 연결 레이어(Fully Connected Layer)를 추가하여 최종적으로 분류나 회귀와 같은 작업을 수행하는 구조를 가집니다.
