# 역기구학 (Inverse Kinematics)

**역기구학(Inverse Kinematics, IK)**은 순기구학(Forward Kinematics)의 반대 문제로, 로봇의 끝점(End-Effector)이 도달하고자 하는 목표 위치(Position)와 방향(Orientation)이 주어졌을 때, 그 자세를 만들기 위한 각 관절(Joint)의 값들을 계산하는 과정입니다.

- **입력:** 목표 엔드 이펙터의 3차원 위치 (x, y, z)와 방향 (Roll, Pitch, Yaw)
- **출력:** 목표를 만족하는 로봇의 각 관절 값 (θ₁, θ₂, d₃, ...)

역기구학은 로봇이 실제로 특정 작업을 수행하도록 프로그래밍하는 데 필수적입니다. 예를 들어 "로봇 팔 끝을 (0.5, 1.0, 0.8) 위치로 이동시켜라"와 같은 명령을 수행하려면, 로봇 제어기는 이 목표 위치에 해당하는 관절 각도들을 역기구학을 통해 계산해야 합니다.

## 역기구학의 특징

역기구학은 순기구학에 비해 훨씬 더 복잡하고 어려운 문제입니다.

- **비선형성(Non-linearity):** 관절 각도와 엔드 이펙터 위치 사이의 관계는 삼각함수 등으로 인해 비선형적입니다. 이로 인해 해를 구하는 방정식이 복잡해집니다.
- **다중 해(Multiple Solutions):** 동일한 엔드 이펙터 자세를 만들 수 있는 관절 각도의 조합이 여러 개 존재할 수 있습니다. 예를 들어, 사람의 팔꿈치를 위로 올리거나 아래로 내린 상태 모두에서 손을 같은 위치에 둘 수 있습니다.
- **해가 없는 경우(No Solution):** 로봇이 물리적으로 도달할 수 없는 위치나 자세(작업 공간 밖)가 목표로 주어지면 해가 존재하지 않습니다.
- **특이점(Singularity):** 로봇이 특정 자세를 취할 때 자유도를 잃어버리는 현상으로, 이 지점에서는 역기구학 해를 구하기 어렵거나 불가능할 수 있습니다.

## 역기구학 해법 (Solving Inverse Kinematics)

역기구학을 푸는 방법은 크게 해석적 해법과 수치적 해법으로 나뉩니다.

### 1. 해석적 해법 (Analytical Solutions)

해석적 해법은 기구학 방정식을 직접 풀어 관절 변수에 대한 닫힌 형태의 해(Closed-form solution)를 구하는 방식입니다.

- **장점:**
  - 계산 속도가 매우 빠릅니다.
  - 해당 자세에 대한 모든 가능한 해를 찾을 수 있습니다.
  - 해의 존재 여부를 명확히 알 수 있습니다.
- **단점:**
  - 로봇의 구조가 간단하고, 특정 조건(예: 6-DoF 로봇에서 3개의 손목 관절 축이 한 점에서 만나는 경우)을 만족할 때만 적용 가능합니다.
  - 복잡한 구조의 로봇(예: 7-DoF 이상의 잉여 로봇, 휴머노이드)에는 적용하기 어렵습니다.

**해법 접근 방식:**
- **기하학적 접근:** 로봇의 구조를 2D 평면에 투영하여 삼각함수와 기하학적 관계를 이용해 관절 각도를 순차적으로 풀어갑니다.
- **대수적 접근:** 순기구학에서 유도된 동차 변환 행렬을 목표 변환 행렬과 같다고 놓고, 행렬의 각 요소를 비교하여 연립방정식을 풀어 해를 구합니다.

### 2. 수치적 해법 (Numerical Solutions)

수치적 해법은 해석적으로 풀기 어려운 복잡한 로봇에 대해 반복적인 계산(Iteration)을 통해 근사 해를 찾는 방식입니다.

- **장점:**
  - 로봇의 구조와 상관없이 일반적으로 적용할 수 있습니다. (잉여 로봇 등 복잡한 로봇에 적합)
- **단점:**
  - 반복 계산으로 인해 계산 속도가 느릴 수 있습니다.
  - 초기 추정값에 따라 해가 달라지거나, 지역 최솟값(Local Minimum)에 빠져 최적의 해를 찾지 못할 수 있습니다.
  - 해가 존재하지 않는 경우에도 계속 계산을 시도할 수 있습니다.

**대표적인 알고리즘:**
- **자코비안 기반 방법 (Jacobian-based Methods):**
  - 자코비안의 역행렬(Inverse Jacobian)이나 의사 역행렬(Pseudo-inverse Jacobian)을 사용하여 현재 자세에서 목표 자세까지의 오차를 점진적으로 줄여나가는 방향으로 관절 각도를 업데이트합니다.
  - `Δθ = J⁻¹ * Δx` (Δθ: 관절 각도 변화량, J: 자코비안, Δx: 엔드 이펙터 위치/방향 오차)
- **최적화 기반 방법 (Optimization-based Methods):**
  - 목표 자세와의 오차를 최소화하는 비용 함수(Cost Function)를 정의하고, 경사 하강법(Gradient Descent)과 같은 최적화 알고리즘을 사용하여 비용 함수를 최소화하는 관절 각도를 찾습니다.
  - 이 방식은 장애물 회피, 에너지 최소화 등 추가적인 제약 조건을 포함시키기 용이합니다.
