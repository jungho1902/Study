# 라그랑주 역학 기반 모델링 (Lagrangian Dynamics)

**로봇 동역학(Robot Dynamics)**은 로봇의 움직임과 그 움직임을 발생시키는 힘/토크 사이의 관계를 연구하는 학문입니다. 즉, 원하는 궤적(Trajectory)으로 로봇을 움직이기 위해 각 관절에 얼마만큼의 토크를 가해야 하는지(역동역학), 또는 각 관절에 특정 토크를 가했을 때 로봇이 어떻게 움직일지(순동역학)를 분석합니다.

**라그랑주 역학(Lagrangian Dynamics)**은 동역학 모델을 수립하는 대표적인 방법 중 하나로, 시스템의 **에너지**를 기반으로 운동 방정식을 유도합니다.

## 라그랑주 역학의 핵심 개념

라그랑주 역학은 개별적인 힘과 가속도를 직접 다루는 뉴턴 역학과 달리, 시스템 전체의 스칼라 값인 운동 에너지(Kinetic Energy)와 위치 에너지(Potential Energy)에 초점을 맞춥니다.

### 1. 라그랑지안 (Lagrangian, ℒ)

라그랑지안은 시스템의 **운동 에너지(K)에서 위치 에너지(P)를 뺀 값**으로 정의됩니다.

`ℒ(q, q̇) = K(q, q̇) - P(q)`

- `K`: 시스템의 총 운동 에너지. 관절의 속도(`q̇`)와 관련이 있습니다.
- `P`: 시스템의 총 위치 에너지. 중력에 의한 위치(관절 각도 `q`에 따라 결정됨)와 관련이 있습니다.
- `q`, `q̇`: 각각 로봇의 일반화 좌표(Generalized Coordinates, 즉 관절 각도/변위)와 일반화 속도(Generalized Velocities, 즉 관절 속도)를 나타냅니다.

### 2. 라그랑주 방정식 (Lagrange's Equation)

시스템의 동역학 방정식은 다음의 라그랑주 방정식을 통해 유도됩니다.

```
d/dt (∂ℒ / ∂q̇ᵢ) - (∂ℒ / ∂qᵢ) = τᵢ
```

- `τᵢ`: `i`번째 일반화 좌표에 해당하는 외부 힘 또는 토크 (예: `i`번째 관절의 모터 토크)
- `∂ℒ / ∂q̇ᵢ`: 일반화 운동량 (Generalized Momentum)
- `∂ℒ / ∂qᵢ`: 일반화 힘 (Generalized Force)

이 방정식을 로봇의 각 관절 `i = 1, 2, ..., n`에 대해 모두 계산하면 로봇의 전체 동역학 모델을 얻을 수 있습니다.

## 로봇 동역학 방정식의 표준 형태

라그랑주 방정식을 통해 유도된 로봇의 동역학 방정식은 일반적으로 다음과 같은 표준 형태로 정리됩니다.

`M(q)q̈ + C(q, q̇)q̇ + G(q) = τ`

- `τ` (n x 1): 각 관절에 가해지는 토크 벡터
- `q`, `q̇`, `q̈` (n x 1): 관절의 각도, 각속도, 각가속도 벡터

---

- `M(q)` (n x n): **관성 행렬 (Inertia Matrix)**
  - 로봇의 질량과 관성에 관련된 항으로, 관절 각도 `q`에 따라 변합니다.
  - 항상 대칭이며 양의 정부호(Positive Definite) 행렬입니다.
  - `q̈` (가속도)에 대한 관절 토크의 관계를 나타냅니다.

- `C(q, q̇)q̇` (n x 1): **코리올리 및 원심력 벡터 (Coriolis and Centrifugal Vector)**
  - `C(q, q̇)`는 코리올리 및 원심력 행렬입니다.
  - 관절들이 동시에 움직일 때 발생하는 상호작용 힘(코리올리 힘)과, 회전으로 인해 발생하는 힘(원심력)을 나타냅니다.
  - 관절 속도 `q̇`에 대한 제곱 항을 포함합니다.

- `G(q)` (n x 1): **중력 벡터 (Gravity Vector)**
  - 각 링크의 무게로 인해 발생하는 중력 부하를 각 관절의 토크로 변환한 것입니다.
  - 관절의 위치 `q`에만 의존합니다.

## 장점 및 단점

### 장점
- **체계적:** 시스템의 에너지만 계산하면 정해진 절차(라그랑주 방정식)에 따라 운동 방정식을 유도할 수 있습니다.
- **좌표계 독립적:** 특정 좌표계를 명시적으로 설정할 필요 없이 일반화 좌표를 사용하여 시스템을 기술할 수 있습니다.
- **내부 힘 무시:** 링크 사이의 구속력 등 내부적인 힘을 고려할 필요 없이 시스템 전체의 동역학을 쉽게 얻을 수 있습니다.

### 단점
- **계산 복잡성:** 운동 에너지와 위치 에너지를 계산하고, 이를 편미분하는 과정이 매우 복잡하고 길어질 수 있습니다. 특히 로봇의 자유도가 증가할수록 계산량이 기하급수적으로 늘어납니다.
- **물리적 직관 부족:** 에너지라는 스칼라 값에서 시작하기 때문에, 뉴턴-오일러 방법처럼 각 링크에 작용하는 힘과 모멘트를 직관적으로 파악하기는 어렵습니다.

라그랑주 방법은 로봇 동역학 모델의 구조를 분석하고 제어 이론을 연구하는 데 주로 사용되며, 실제 실시간 제어를 위한 계산에는 뉴턴-오일러 방법이 더 효율적일 수 있습니다.
