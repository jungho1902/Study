# 하이브리드 추천 시스템 (Hybrid Recommender Systems)

**하이브리드 추천 시스템(Hybrid Recommender Systems)**은 단일 추천 알고리즘(예: 콘텐츠 기반 필터링, 협업 필터링)이 가진 단점을 보완하고 장점을 극대화하기 위해, **두 가지 이상의 추천 기술을 결합**하는 방식입니다.

실제 상용 추천 시스템의 대부분은 특정 상황에서 발생하는 문제를 해결하기 위해 하이브리드 방식을 채택하고 있습니다. 예를 들어, 협업 필터링의 콜드 스타트(Cold Start) 문제를 콘텐츠 기반 필터링을 통해 완화하는 것이 대표적인 사례입니다.

## 1. 하이브리드 모델이 필요한 이유

- **콜드 스타트 문제 완화:**
  - **신규 사용자:** 활동 기록이 없는 사용자에게는 협업 필터링 적용이 어렵습니다. 이때는 사용자의 가입 정보(나이, 성별 등)나 명시적인 선호도 조사를 바탕으로 콘텐츠 기반 추천을 먼저 제공할 수 있습니다.
  - **신규 아이템:** 사용자 평가가 없는 새로운 아이템은 협업 필터링으로 추천되기 어렵습니다. 아이템 자체의 콘텐츠(장르, 카테고리, 설명 등)를 분석하여 콘텐츠 기반으로 추천을 생성할 수 있습니다.
- **데이터 희소성 문제 개선:** 사용자-아이템 상호작용이 매우 적을 때, 아이템의 콘텐츠 정보나 사용자의 프로필 정보를 함께 사용하면 더 안정적인 추천이 가능합니다.
- **추천 정확도 및 다양성 향상:** 각기 다른 장점을 가진 모델들을 결합함으로써, 한 가지 모델만 사용했을 때보다 더 정확하고 사용자에게 만족스러운 추천을 제공할 수 있습니다. 예를 들어, 협업 필터링의 정확성과 콘텐츠 기반 필터링의 새로움(Serendipity)을 동시에 추구할 수 있습니다.

## 2. 주요 하이브리드 결합 방식

하이브리드 모델을 구현하는 방식은 다양하며, 대표적으로 다음과 같은 전략들이 있습니다.

### 2.1. 가중치 기반 결합 (Weighted Hybrid)

- 가장 간단한 결합 방식으로, 여러 추천 모델 각각의 예측 점수(또는 순위)를 계산한 뒤, 이 점수들에 **가중치를 부여하여 선형적으로 결합**합니다.
- `최종 점수 = α * (모델 A의 점수) + (1-α) * (모델 B의 점수)`
- 가중치 `α`는 오프라인 테스트를 통해 최적의 값을 찾거나, 상황에 따라 동적으로 조절할 수 있습니다. 예를 들어, 신규 사용자에게는 콘텐츠 기반 모델의 가중치를 높게 설정할 수 있습니다.

### 2.2. 스위칭 기반 결합 (Switching Hybrid)

- 특정 **조건이나 상황에 따라** 사용할 추천 모델을 전환하는 방식입니다.
- 예를 들어:
  - 사용자의 활동 기록이 일정 수 미만이면 콘텐츠 기반 모델을 사용하고, 그 이상이면 협업 필터링 모델을 사용합니다.
  - 아이템에 대한 평가 데이터가 충분하면 협업 필터링을, 부족하면 콘텐츠 기반 필터링을 사용합니다.
  - 사용자가 속한 세그먼트(예: 신규 사용자, 충성 사용자)에 따라 다른 모델을 적용할 수도 있습니다.

### 2.3. 특징 결합 (Feature Combination)

- 하나의 모델에 다른 모델의 특징을 결합하여 사용하는 방식입니다.
- 예를 들어, 협업 필터링의 잠재 요인 모델(Latent Factor Model)을 학습할 때, 사용자와 아이템의 상호작용 데이터뿐만 아니라, **콘텐츠 기반의 특징(예: 아이템의 장르, 텍스트 임베딩)을 추가적인 입력 특징으로 함께 사용**하여 학습시킵니다.
- 딥러닝 기반 모델들은 이러한 특징 결합을 매우 유연하게 수행할 수 있습니다. (예: Wide & Deep 모델)

### 2.4. 계단식 결합 (Cascade Hybrid)

- 여러 모델을 단계적으로 적용하는 방식으로, 첫 번째 모델이 추천 후보군을 걸러내면 다음 모델이 그 후보군 내에서 더 정밀하게 순위를 매기는 방식입니다.
- **1단계 (후보 생성, Candidate Generation):** 계산이 빠르지만 상대적으로 덜 정확한 모델(예: 아이템 기반 CF)을 사용하여 수백~수천 개의 추천 후보 아이템을 빠르게 생성합니다.
- **2단계 (순위 결정, Ranking):** 계산이 복잡하지만 더 정확한 모델(예: 딥러닝 모델)을 사용하여 1단계에서 생성된 후보들의 순위를 정밀하게 매겨 최종 추천 리스트를 생성합니다.
- 이 방식은 대규모 추천 시스템에서 계산 효율성과 정확성을 모두 잡기 위해 널리 사용됩니다. (예: 유튜브, 페이스북)

### 2.5. 앙상블 (Ensemble)

- 머신러닝의 앙상블 기법(배깅, 부스팅 등)과 유사하게, 여러 추천 모델의 예측 결과를 **조합(voting, stacking 등)**하여 최종 추천을 결정합니다.
- 예를 들어, 여러 다른 추천 모델들이 공통적으로 추천하는 아이템의 순위를 높여줄 수 있습니다.

하이브리드 추천 시스템은 단일 모델의 한계를 명확히 인지하고, 이를 보완할 수 있는 다른 모델과의 시너지를 어떻게 설계하느냐가 핵심입니다. 복잡성이 증가하는 단점이 있지만, 대부분의 경우 더 강건하고 만족스러운 추천 결과를 제공합니다.
