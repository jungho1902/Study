# 협업 필터링 (Collaborative Filtering)

**협업 필터링(Collaborative Filtering, CF)**은 추천 시스템에서 가장 널리 사용되고 성공적인 접근 방식 중 하나입니다. 핵심 아이디어는 **"당신과 비슷한 취향을 가진 다른 사람들이 좋아한 아이템을 당신도 좋아할 것이다"** 또는 **"당신이 좋아한 아이템과 비슷한 아이템을 다른 사람들도 좋아할 것이다"**라는 가정에 기반합니다.

콘텐츠 기반 필터링과 달리 아이템의 고유한 속성을 전혀 사용하지 않고, 오직 **사용자와 아이템 간의 상호작용 데이터(interaction data)**(예: 평점, 구매 내역, 클릭 기록)만을 가지고 추천을 생성합니다.

## 1. 협업 필터링의 주요 유형

협업 필터링은 크게 **최근접 이웃 기반 필터링**과 **잠재 요인 모델**로 나뉩니다.

### 1.1. 최근접 이웃 기반 필터링 (Neighborhood-based CF)

메모리 기반(Memory-based) CF라고도 불리며, 사용자와 아이템 간의 평점 행렬(Rating Matrix)을 기반으로 유사도를 계산하여 추천을 생성합니다.

#### **A. 사용자 기반 협업 필터링 (User-based CF, UBCF)**

1. **유사한 사용자 찾기:** 추천 대상 사용자와 유사한 취향을 가진 다른 사용자들(neighbors)을 찾습니다.
   - **유사도 척도:** 피어슨 상관계수(Pearson Correlation), 코사인 유사도(Cosine Similarity), MSD(Mean Squared Difference) 등이 사용됩니다.
2. **평점 예측:** 유사한 사용자들이 높게 평가했지만, 추천 대상 사용자는 아직 보지 않은 아이템을 찾습니다.
3. **추천:** 이 아이템들에 대한 예상 평점을 계산(유사도 가중 평균 등)하여, 평점이 가장 높을 것으로 예측되는 아이템을 추천합니다.

- **장점:** 추천의 원리를 직관적으로 이해하기 쉽습니다.
- **단점:** 사용자 수가 많아지면 유사도 계산량이 폭발적으로 증가하여 확장성(scalability)이 떨어집니다.

#### **B. 아이템 기반 협업 필터링 (Item-based CF, IBCF)**

1. **유사한 아이템 찾기:** 추천 대상 사용자가 과거에 높게 평가했던 아이템들과 유사한 평가 패턴을 받은 다른 아이템들을 찾습니다.
   - **유사도 척도:** 주로 코사인 유사도가 사용됩니다. (평점 행렬에서 아이템 벡터 간의 유사도 계산)
2. **평점 예측:** 사용자가 과거에 좋아했던 아이템들과 유사한 아이템들 중에서, 사용자가 아직 보지 않은 아이템을 찾습니다.
3. **추천:** 이 아이템들에 대한 예상 평점을 계산하여 추천합니다.

- **장점:** 일반적으로 사용자보다 아이템의 수가 적고, 아이템 간의 유사도는 상대적으로 잘 변하지 않으므로 사용자 기반 CF보다 계산 효율성과 확장성이 좋습니다. Amazon, Netflix 등 많은 기업에서 초기에 성공적으로 도입했습니다.
- **단점:** 사용자와 아이템 간의 상호작용이 매우 희소(sparse)할 경우, 아이템 간 유사도 계산이 부정확해질 수 있습니다.

### 1.2. 잠재 요인 모델 (Latent Factor Models)

모델 기반(Model-based) CF라고도 불리며, 사용자와 아이템 간의 상호작용 패턴 뒤에 숨어있는 **잠재적인 요인(latent factors)**을 찾아내어 추천에 활용하는 방식입니다.

#### **행렬 분해 (Matrix Factorization, MF)**

- **핵심 아이디어:** `m x n` 크기의 거대한 사용자-아이템 평점 행렬 `R`을 `m x k` 크기의 사용자-잠재요인 행렬 `P`와 `k x n` 크기의 아이템-잠재요인 행렬 `Q`의 곱으로 분해(`R ≈ P x Q^T`)합니다.
  - 여기서 `k`는 잠재 요인의 차원 수로, 하이퍼파라미터입니다. (보통 수십~수백)
  - **잠재 요인:** 이 요인들은 명시적으로 정의되지 않지만, 예를 들어 영화라면 '액션성', '코미디 요소', '작품성' 등과 같은 추상적인 특징을 나타낼 수 있습니다.
- **학습 과정:**
  1. 행렬 `P`와 `Q`를 무작위 값으로 초기화합니다.
  2. 실제 평점 `R`과 예측 평점 `P x Q^T` 간의 오차를 최소화하는 방향으로 `P`와 `Q`를 반복적으로 업데이트합니다. (주로 경사 하강법(SGD)이나 ALS(Alternating Least Squares) 사용)
- **평점 예측 및 추천:** 학습이 완료된 `P`와 `Q`를 곱하면, 사용자가 아직 평가하지 않은 아이템에 대한 평점까지 예측할 수 있는 완성된 행렬을 얻게 됩니다. 이를 기반으로 추천을 생성합니다.
- **장점:**
  - **높은 예측 정확도:** 희소한 데이터에서도 준수한 성능을 보이며, 대규모 데이터셋에 대한 확장성이 뛰어납니다.
  - **일반화 능력:** 과대적합을 방지하기 위한 규제(regularization)를 추가하기 용이합니다.
- **대표적인 알고리즘:** SVD(Singular Value Decomposition), NMF(Non-negative Matrix Factorization) 등이 행렬 분해에 기반한 주요 기법들입니다.

## 2. 협업 필터링의 한계

- **콜드 스타트 문제 (Cold Start Problem):**
  - **신규 사용자 (New User):** 시스템에 새로 가입하여 활동 기록이 없는 사용자에게는 누구와 유사한지 알 수 없어 추천이 불가능합니다.
  - **신규 아이템 (New Item):** 시스템에 새로 추가되어 아무도 평가하지 않은 아이템은 추천될 수 없습니다.
- **데이터 희소성 문제 (Data Sparsity):** 대부분의 사용자는 전체 아이템 중 극히 일부만 소비하므로, 사용자-아이템 행렬이 매우 비어있습니다. 이로 인해 유사도 계산이나 잠재 요인 학습이 어려워질 수 있습니다.
- **계산량 문제 (Scalability):** 특히 최근접 이웃 기반 방식은 사용자/아이템 수가 늘어날수록 계산 비용이 크게 증가합니다.

이러한 한계들을 극복하기 위해 콘텐츠 기반 필터링이나 딥러닝 모델과 결합한 **하이브리드 방식**이 널리 연구되고 있습니다.
