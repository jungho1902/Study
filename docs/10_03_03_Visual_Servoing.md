# 파트 10: AI 기반 로봇 응용 (AI-Powered Robotic Applications)

## 10.3. 항공 로보틱스 (Aerial Robotics / Drones)

### 10.3.3. 비전 기반 자율 비행 (Visual Servoing)

**들어가며**

GPS는 훌륭한 위치 센서이지만, GPS 신호가 닿지 않는 실내, 다리 밑, 도심 빌딩 숲과 같은 환경에서는 무용지물이 됩니다. 또한 GPS는 수 미터의 오차를 가질 수 있어, 특정 대상에 정밀하게 접근하거나 시설물을 검사하는 등의 임무에는 한계가 있습니다. **비전 기반 자율 비행(Visual Servoing)**은 이러한 한계를 극복하기 위해, GPS 대신 **카메라(Vision)를 주 센서로** 사용하여 드론의 움직임을 제어하는 기술입니다. 이 기술의 핵심은 '이미지에서 보이는 모습'을 기반으로 드론의 제어 명령을 직접 생성하는 것입니다.

---

**1. Visual Servoing 이란?**

Visual Servoing은 **이미지 공간(Image Space)에서의 오차**를 이용해 로봇을 제어하는 기법입니다. 즉, '실제 3D 공간에서의 위치 오차'가 아닌, '카메라 이미지에 보이는 목표물의 현재 모습과 원하는 모습 간의 차이'를 최소화하도록 로봇을 움직입니다.

- **예시:** 드론의 카메라가 특정 표식을 추적한다고 가정해 봅시다.
  - **목표:** 표식이 이미지의 중앙에, 특정 크기로 보이도록 유지하는 것.
  - **오차 정의:**
    - `오차 1`: 이미지 상에서 표식의 현재 픽셀 위치와 이미지 중앙 픽셀 위치의 차이.
    - `오차 2`: 이미지 상에서 표식의 현재 크기와 목표 크기의 차이.
  - **제어:** 이 오차들을 0으로 만들기 위한 드론의 움직임(전후, 좌우, 상하, 회전)을 계산하여 모터에 명령을 내립니다. 예를 들어, 표식이 이미지의 오른쪽에 보이면 드론을 오른쪽으로 움직이고, 표식이 너무 작게 보이면 앞으로 전진합니다.

---

**2. Visual Servoing의 종류**

어떤 공간의 오차를 기준으로 제어하느냐에 따라 크게 두 가지로 나뉩니다.

- **IBVS (Image-Based Visual Servoing):**
  - **개념:** 이름 그대로, **이미지 공간(2D)**에서 정의된 오차를 직접 사용하여 제어합니다.
  - **동작:** 이미지에 보이는 특징점(feature)들의 현재 픽셀 좌표($`f`$)와 목표 픽셀 좌표($`f_{des}`$)의 차이($`e = f - f_{des}`$)를 계산하고, 이 오차를 줄이기 위한 카메라의 속도를 계산합니다.
  - **상호작용 행렬 (Interaction Matrix / Image Jacobian):** 이미지 특징점의 속도와 카메라의 속도(병진, 회전) 사이의 관계를 나타내는 행렬($`L_f`$)입니다. 이 행렬의 역(inverse)을 이용해 이미지 오차로부터 필요한 카메라 속도를 계산할 수 있습니다.
  - **장점:**
    - 카메라의 3D 위치를 명시적으로 추정할 필요가 없습니다.
    - 특징점이 항상 카메라 시야 내에 머무르려는 경향이 있어 안정적입니다.
  - **단점:**
    - 카메라가 물리적으로 이상한 경로(예: 뒤로 갔다가 다시 앞으로 오는)로 움직일 수 있습니다.
    - 상호작용 행렬이 특정 카메라 자세(특이점, singularity)에서 계산 불가능해질 수 있습니다.

- **PBVS (Position-Based Visual Servoing):**
  - **개념:** **3D 작업 공간(Task Space)**에서 정의된 오차를 사용하여 제어합니다.
  - **동작:**
    1.  이미지에 보이는 특징점들을 이용해 카메라(드론)의 **현재 3D 자세(위치, 방향)를 추정**합니다. (이는 파트 10.2.1의 자세 추정과 동일한 문제입니다.)
    2.  추정된 현재 3D 자세와 목표 3D 자세 간의 오차를 계산합니다.
    3.  이 3D 공간의 오차를 줄이기 위한 제어 명령을 생성합니다. (이는 일반적인 로봇 제어 문제와 같습니다.)
  - **장점:**
    - 3D 공간에서 직접 경로를 제어하므로, 직관적이고 예측 가능한 움직임을 보입니다.
    - IBVS의 특이점 문제가 발생하지 않습니다.
  - **단점:**
    - 카메라의 3D 자세를 정확하게 추정해야 하며, 이 과정에서 발생하는 오차에 제어 성능이 민감하게 반응합니다.
    - 3D 자세 추정 오차로 인해 특징점이 카메라 시야 밖으로 벗어날 위험이 있습니다.

- **하이브리드 방식 (Hybrid Approaches / 2.5D Visual Servoing):**
  - IBVS와 PBVS의 장점을 결합하려는 시도입니다. 예를 들어, x, y 방향 이동은 IBVS로 제어하여 안정성을 확보하고, z 방향(깊이) 이동은 PBVS로 제어하여 직관성을 높이는 방식 등이 있습니다.

---

**3. Visual Odometry (VO) 와의 연계**

Visual Servoing이 '목표물'을 기준으로 제어하는 기술이라면, **Visual Odometry(VO)**는 연속적인 카메라 이미지를 이용해 '드론 자신의 움직임'을 추정하는 기술입니다. VO는 Visual SLAM(파트 10.1.2)에서 지도 작성(Mapping)과 루프 클로징(Loop Closing) 부분을 제외한, 순수한 위치 추정 부분에 해당합니다. GPS가 없는 환경에서 드론의 위치를 추정하는 핵심 기술이며, Visual Servoing을 위한 현재 상태 정보를 제공하는 역할을 합니다.

**결론**

Visual Servoing은 카메라를 '눈'으로만 사용하는 것을 넘어, '길잡이'로 사용하는 강력한 기술입니다. 이미지 정보를 제어 루프에 직접 통합함으로써, GPS 없이도 정밀한 상대 위치 제어를 가능하게 합니다. 이는 교량이나 건물 같은 거대 구조물 검사, 다른 이동 로봇과의 상호작용, 실내 자율 비행 등 드론의 응용 분야를 획기적으로 확장시키는 핵심 기술이라 할 수 있습니다.
