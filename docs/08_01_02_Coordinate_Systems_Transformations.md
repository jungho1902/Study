# 좌표계와 변환 (Coordinate Systems and Transformations)

로봇을 제어하기 위해서는 로봇의 각 부분과 주변 환경에 있는 물체들의 위치와 방향을 수학적으로 표현하고 관계를 정의해야 합니다. 이를 위해 **좌표계(Coordinate System)**와 **변환(Transformation)**의 개념이 사용됩니다.

## 1. 좌표계 (Coordinate Systems)

로봇공학에서는 일반적으로 3차원 직교 좌표계를 사용하며, 여러 개의 좌표계가 목적에 따라 정의됩니다.

- **월드 좌표계 (World Frame / Global Frame):** 모든 로봇과 물체의 위치를 표현하는 기준이 되는 절대적인 좌표계입니다. 환경에 고정되어 있으며 변하지 않습니다.
- **로봇 베이스 좌표계 (Robot Base Frame):** 로봇의 베이스(몸체)에 고정된 좌표계입니다. 로봇의 움직임에 따라 이 좌표계 자체는 월드 좌표계에 대해 이동하고 회전할 수 있습니다.
- **엔드 이펙터 좌표계 (End-Effector Frame / Tool Frame):** 로봇 팔의 끝부분, 즉 작업을 수행하는 도구(그리퍼, 용접기 등)에 부착된 좌표계입니다. 로봇의 관절이 움직임에 따라 베이스 좌표계에 대한 위치와 방향이 계속 변합니다.
- **물체 좌표계 (Object Frame):** 작업 대상이 되는 물체에 설정된 좌표계입니다.
- **카메라 좌표계 (Camera Frame):** 로봇에 부착된 카메라의 렌즈 중심에 설정된 좌표계입니다.

로봇의 목표는 결국 '물체 좌표계'에 대해 '엔드 이펙터 좌표계'를 원하는 위치와 방향으로 일치시키는 것이라고 할 수 있습니다. 이를 위해서는 각 좌표계 간의 관계를 알아야 하며, 이때 '변환'이 사용됩니다.

## 2. 변환 (Transformations)

변환은 한 좌표계에서 표현된 점의 위치를 다른 좌표계에서 표현된 위치로 바꾸는 과정을 의미합니다. 3차원 공간에서의 변환은 **이동(Translation)**과 **회전(Rotation)**으로 구성됩니다.

### 가. 이동 (Translation)

이동은 특정 방향으로 좌표를 평행 이동시키는 것입니다. 점 P를 벡터 t = (tx, ty, tz) 만큼 이동시켜 점 P'를 얻는 것은 간단한 덧셈으로 표현됩니다.

`P' = P + t`

### 나. 회전 (Rotation)

회전은 특정 축을 기준으로 좌표를 회전시키는 것입니다. 3차원 공간에서의 회전은 **회전 행렬(Rotation Matrix)**을 사용하여 표현됩니다. 회전 행렬은 3x3 크기의 직교 행렬(Orthogonal Matrix)입니다.

- **X축 기준 회전 (Roll):**
  ```
  Rx(θ) =
  | 1    0        0      |
  | 0  cos(θ)  -sin(θ) |
  | 0  sin(θ)   cos(θ) |
  ```

- **Y축 기준 회전 (Pitch):**
  ```
  Ry(θ) =
  | cos(θ)   0   sin(θ) |
  |   0      1     0    |
  | -sin(θ)  0   cos(θ) |
  ```

- **Z축 기준 회전 (Yaw):**
  ```
  Rz(θ) =
  | cos(θ)  -sin(θ)   0 |
  | sin(θ)   cos(θ)   0 |
  |   0        0      1 |
  ```

좌표계 {A}에서 표현된 점 `Pa`를 좌표계 {B}로 변환하기 위해서는 {A}를 {B} 기준으로 어떻게 회전시켰는지를 나타내는 회전 행렬 `R_B_A`를 곱해줍니다.

`Pb = R_B_A * Pa`

## 3. 동차 변환 행렬 (Homogeneous Transformation Matrix)

로봇의 움직임은 이동과 회전이 복합적으로 발생합니다. 이 두 변환을 하나의 행렬 연산으로 통합하여 표현하기 위해 **동차 변환 행렬(Homogeneous Transformation Matrix)**을 사용합니다.

동차 변환 행렬은 4x4 크기의 행렬로, 회전과 이동 정보를 모두 포함하고 있습니다.

```
      |           |      |
T =   |    R_3x3    | t_3x1  |
      |           |      |
      |-----------|------|
      | 0   0   0 |   1  |
```

- **R_3x3:** 3x3 회전 행렬 (Rotation Matrix)
- **t_3x1:** 3x1 이동 벡터 (Translation Vector)

이를 이용하면, 좌표계 {A}에서 표현된 점 `Pa`를 좌표계 {B}로 변환하는 과정(회전 후 이동)을 단일 행렬 곱으로 계산할 수 있습니다. (점 `Pa`는 `[px, py, pz, 1]` 형태의 동차 좌표로 표현)

`Pb_homo = T_B_A * Pa_homo`

이 동차 변환 행렬은 로봇의 순기구학(Forward Kinematics)에서 로봇 베이스 좌표계부터 엔드 이펙터 좌표계까지의 관계를 연쇄적으로 계산하는 데 핵심적인 역할을 합니다.
