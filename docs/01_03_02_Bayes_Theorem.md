# 베이즈 정리 (Bayes' Theorem)

**베이즈 정리(Bayes' Theorem)**는 조건부 확률(Conditional Probability)을 이용하여 두 확률 변수의 사전 확률(Prior)과 사후 확률(Posterior) 사이의 관계를 설명하는 정리입니다. 즉, 어떤 사건에 대한 **새로운 증거(Evidence)가 주어졌을 때, 이 증거를 바탕으로 기존의 믿음(Prior)을 어떻게 갱신(Update)해야 하는지**에 대한 수학적인 틀을 제공합니다.

베이즈 정리는 스팸 메일 필터링, 의료 진단, 머신러닝의 베이지안 추론 등 불확실성 하에서의 추론이 필요한 다양한 분야에서 핵심적인 역할을 합니다.

## 베이즈 정리 공식

사건 A와 사건 B에 대하여, 베이즈 정리 공식은 다음과 같습니다.

`P(A|B) = [ P(B|A) * P(A) ] / P(B)`

각 항은 다음과 같은 의미를 가집니다.

- `P(A|B)`: **사후 확률 (Posterior Probability)**
  - 사건 B라는 새로운 정보(증거)가 주어진 후의 사건 A의 확률.
  - 우리가 최종적으로 구하고자 하는 값입니다. (예: 어떤 이메일의 내용(B)을 봤을 때, 이 이메일이 스팸(A)일 확률)

- `P(B|A)`: **가능도 (Likelihood)**
  - 사건 A가 사실일 때, 사건 B가 발생할 확률.
  - 주어진 가설(A) 하에서 현재의 증거(B)가 얼마나 그럴듯한지를 나타냅니다. (예: 스팸 메일(A)일 경우, '당첨'이라는 단어(B)가 포함될 확률)

- `P(A)`: **사전 확률 (Prior Probability)**
  - 사건 B에 대한 정보를 알기 전의 사건 A에 대한 초기 확률(믿음의 정도).
  - 아무런 증거가 없을 때, 사건 A가 발생할 것이라고 예상하는 확률입니다. (예: 전체 메일 중 스팸 메일(A)이 차지하는 일반적인 비율)

- `P(B)`: **증거 (Evidence) 또는 주변 가능도 (Marginal Likelihood)**
  - 사건 A와는 관계없이 사건 B가 발생할 확률.
  - 사후 확률을 정규화(Normalize)하는 역할을 합니다. 즉, 계산된 사후 확률의 합이 1이 되도록 보장합니다.
  - `P(B) = P(B|A) * P(A) + P(B|¬A) * P(¬A)` 와 같이 계산할 수 있습니다. (¬A: A가 아닌 사건)

## 예시: 질병 진단

어떤 질병(A)의 유병률이 1%라고 알려져 있습니다 (`P(A) = 0.01`). 이 질병을 진단하는 검사(B)가 있는데, 이 검사의 정확도는 다음과 같습니다.
- 질병에 걸린 사람을 양성(Positive)으로 진단할 확률: `P(B|A) = 0.9` (민감도, Sensitivity)
- 질병에 걸리지 않은 사람을 음성(Negative)으로 진단할 확률: `P(¬B|¬A) = 0.8` (특이도, Specificity)

**문제:** 어떤 사람이 이 검사에서 **양성(B) 판정**을 받았을 때, **실제로 이 질병에 걸렸을(A) 확률** `P(A|B)`는 얼마일까요?

### 1. 각 확률 값 정리
- `P(A)` = 0.01 (사전 확률: 이 사람이 질병에 걸렸을 확률)
- `P(¬A)` = 1 - P(A) = 0.99 (이 사람이 질병에 걸리지 않았을 확률)
- `P(B|A)` = 0.9 (가능도: 병에 걸렸는데 양성으로 나올 확률)
- `P(B|¬A)` = 1 - P(¬B|¬A) = 1 - 0.8 = 0.2 (병에 안 걸렸는데 양성으로 나올 확률, False Positive Rate)

### 2. 증거 `P(B)` 계산
`P(B)`는 양성 판정이 나올 전체 확률입니다.
`P(B) = P(B|A) * P(A) + P(B|¬A) * P(¬A)`
`P(B) = (0.9 * 0.01) + (0.2 * 0.99)`
`P(B) = 0.009 + 0.198 = 0.207`

### 3. 베이즈 정리 적용
`P(A|B) = [ P(B|A) * P(A) ] / P(B)`
`P(A|B) = (0.9 * 0.01) / 0.207`
`P(A|B) = 0.009 / 0.207 ≈ 0.0435`

### 결론
검사 결과가 양성으로 나왔음에도 불구하고, 이 사람이 실제로 질병에 걸렸을 확률(사후 확률)은 약 **4.35%**에 불과합니다.

이는 질병 자체가 매우 희귀하고(`P(A)`가 매우 낮음), 건강한 사람이 잘못된 양성 판정을 받는 경우(`P(B|¬A)`)가 실제로 아픈 사람이 양성 판정을 받는 경우보다 훨씬 많기 때문입니다. 이처럼 베이즈 정리는 우리의 직관과 다른 놀라운 통찰을 제공하며, 불확실한 정보를 바탕으로 합리적인 추론을 가능하게 합니다.
