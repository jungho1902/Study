# 드롭아웃 (Dropout)

## 1. 드롭아웃의 개념과 목적

**드롭아웃(Dropout)**은 딥러닝 모델의 **과대적합(Overfitting)**을 방지하기 위해 사용되는 대표적인 **규제(Regularization)** 기법입니다.

- **과대적합이란?** 모델이 훈련 데이터에만 너무 과도하게 최적화되어, 새로운 데이터(테스트 데이터)에 대해서는 일반화 성능이 떨어지는 현상을 말합니다.

드롭아웃은 학습 과정 동안 신경망의 일부 뉴런을 **무작위로 비활성화(OFF)**시킴으로써 모델이 특정 뉴런이나 특징에 과도하게 의존하는 것을 막습니다.

## 2. 드롭아웃의 동작 원리

1.  **뉴런 선택:** 학습 시, 각 미니배치를 처리할 때마다 신경망의 특정 층(보통 은닉층)에 있는 뉴런들을 정해진 **확률(p)**로 선택합니다. 이 확률 `p`는 드롭아웃 비율(dropout rate)이라고 하며, 보통 0.2에서 0.5 사이의 값을 사용합니다.
2.  **뉴런 비활성화:** 선택된 뉴런들의 출력을 0으로 만듭니다. 즉, 해당 뉴런들은 순전파(forward propagation)와 역전파(backward propagation) 과정에 참여하지 않게 됩니다.
3.  **크기 보정 (Scaling):** 드롭아웃을 적용하면 해당 층의 전체 출력 크기가 작아집니다. 예를 들어, `p=0.5`이면 출력의 총합이 절반으로 줄어듭니다. 이를 보상하기 위해, 살아남은 뉴런들의 출력을 `1 / (1 - p)` 만큼 증폭시켜 줍니다. 이를 통해 학습 시와 추론 시의 출력 크기(scale)를 맞춰줍니다. (이 과정은 대부분의 딥러닝 프레임워크에서 자동으로 처리됩니다.)

이 과정은 매 미니배치마다 반복되며, 매번 다른 뉴런들이 무작위로 비활성화됩니다.

**시각적 예시:**

```
      (학습 전)                  (드롭아웃 적용 후)
    +-----------+                +-----------+
    |  입력 층  |                |  입력 층  |
    +-----------+                +-----------+
         | | |                      | | |
         v v v                      v v v
    +-----------+                +-----------+
    | O  O  O  O | (은닉층)      | O  X  O  X | (O: 활성, X: 비활성)
    +-----------+                +-----------+
         | | |                      |   |
         v v v                      v   v
    +-----------+                +-----------+
    |  출력 층  |                |  출력 층  |
    +-----------+                +-----------+
```

## 3. 드롭아웃의 효과

### 3.1. 앙상블 (Ensemble) 효과
드롭아웃은 매 학습 단계마다 다른 구조의 "더 얇은(thinned)" 신경망을 학습시키는 것과 같습니다. 결과적으로, 하나의 신경망을 학습시키지만 마치 수많은 다른 신경망을 학습시켜 그 결과를 종합하는 **앙상블(Ensemble)** 모델과 유사한 효과를 냅니다. 이는 모델의 일반화 성능을 크게 향상시킵니다.

### 3.2. 동조화 (Co-adaptation) 방지
드롭아웃은 특정 뉴런들이 함께 강하게 활성화되는 **동조화(co-adaptation)** 현상을 방지합니다. 뉴런들은 언제 동료 뉴런이 비활성화될지 모르기 때문에, 다른 특정 뉴런에 의존하기보다는 스스로 독립적으로 유용한 특징을 학습하도록 강제됩니다. 이는 더 강건한(robust) 특징 추출로 이어집니다.

## 4. 주의할 점

- **학습 시에만 적용:** 드롭아웃은 오직 모델을 **학습(training)**할 때만 사용해야 합니다. 모델 **평가 및 추론(evaluation/inference)** 시에는 모든 뉴런을 사용해야 합니다. 대부분의 프레임워크는 모델의 모드(train/eval)에 따라 드롭아웃 적용 여부를 자동으로 관리해줍니다.
- **적용 위치:** 주로 뉴런의 수가 많은 은닉층에 적용하며, 출력층에는 일반적으로 사용하지 않습니다.

드롭아웃은 구현이 간단하면서도 과대적합을 효과적으로 방지할 수 있어, 배치 정규화와 함께 현대 딥러닝 모델에서 널리 사용되는 필수적인 규제 기법입니다.
