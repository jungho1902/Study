# 3.2.2. t-SNE (t-Distributed Stochastic Neighbor Embedding)

**t-SNE**는 고차원 데이터를 2차원 또는 3차원의 저차원 공간으로 시각화하는 데 가장 널리 사용되는 강력한 **비선형 차원 축소** 기법입니다. PCA가 데이터의 전역적인(global) 분산을 보존하는 데 초점을 맞춘다면, t-SNE는 데이터 포인트 간의 **지역적인(local) 유사성**을 보존하는 데 초점을 맞춥니다.

## 1. t-SNE의 핵심 아이디어

t-SNE의 목표는 고차원 공간에서 가까이 있는 데이터 포인트들은 저차원 공간에서도 여전히 가깝게, 그리고 멀리 있는 데이터 포인트들은 멀리 떨어져 있도록 표현하는 것입니다.

이를 위해 두 단계의 확률 분포를 사용합니다.

1.  **고차원 공간에서의 유사도 계산**:
    - 고차원 공간에 있는 각 데이터 포인트 쌍에 대해, 두 포인트가 얼마나 유사한지를 **조건부 확률**로 변환합니다.
    - 특정 포인트 `xᵢ`가 이웃으로 `xⱼ`를 선택할 확률을 계산하는데, 이 확률은 두 포인트 사이의 유클리드 거리가 가까울수록 커집니다 (가우시안 분포 사용).

2.  **저차원 공간에서의 유사도 계산 및 최적화**:
    - 고차원 포인트들을 저차원 공간(주로 2D 또는 3D)에 무작위로 배치합니다.
    - 저차원 공간에 있는 포인트들에 대해서도 위와 유사하게 유사도(조건부 확률)를 계산합니다. 이때는 가우시안 분포보다 꼬리가 두꺼운 **t-분포(Student's t-distribution)**를 사용합니다. t-분포를 사용하면, 고차원에서 멀리 떨어져 있던 포인트들이 저차원에서 더 멀리 떨어지게 되어 군집이 시각적으로 더 명확하게 구분되는 효과가 있습니다.
    - 마지막으로, 고차원 공간에서의 확률 분포와 저차원 공간에서의 확률 분포가 최대한 비슷해지도록, 저차원 공간의 포인트 위치를 반복적으로 조정(최적화)합니다. (두 분포 간의 차이는 쿨백-라이블러 발산(KL-Divergence)으로 측정)

## 2. PCA vs. t-SNE

| 구분 | **PCA** | **t-SNE** |
| --- | --- | --- |
| **목표** | 전역적 분산(Global Variance) 최대화 | 지역적 유사성(Local Similarity) 보존 |
| **선형성** | 선형(Linear) 기법 | 비선형(Non-linear) 기법 |
| **주요 용도** | 일반적인 차원 축소, 특성 공학 | **데이터 시각화 (2D/3D)** |
| **결과 해석** | 주성분 축은 분산의 방향을 의미 | 군집 간 거리나 크기는 의미 없음 |

**매우 중요한 점**: t-SNE는 **탐색적 데이터 분석을 위한 시각화 도구**이지, PCA처럼 일반적인 차원 축소 전처리 도구로 사용해서는 안 됩니다. t-SNE는 지역적 구조만 보존하므로, 결과로 나온 군집의 크기, 군집 간의 상대적 거리 등은 실제 데이터의 특성을 반영하지 않을 수 있습니다.

## 3. 주요 하이퍼파라미터

- **`perplexity`**:
  - 각 데이터 포인트가 고려하는 이웃의 수와 관련된 값으로, t-SNE에서 가장 중요한 하이퍼파라미터입니다.
  - 데이터의 지역적 구조와 전역적 구조 사이의 균형을 조절합니다.
  - 일반적으로 `5`에서 `50` 사이의 값을 사용하며, 데이터셋의 크기에 따라 조정이 필요합니다.
  - 값이 너무 작으면 데이터의 미세한 구조에만 집중하고, 너무 크면 전역적인 구조에 치우쳐 세부적인 군집을 놓칠 수 있습니다.

- **`n_iter` (iterations)**:
  - 최적화를 위한 반복 횟수입니다.
  - 안정적인 시각화 결과를 얻기 위해서는 최소 `1000`회 이상의 충분한 반복이 필요합니다.

- **`learning_rate`**:
  - 최적화 과정에서 각 포인트가 얼마나 이동할지를 결정하는 학습률입니다.

## 4. t-SNE 결과 해석 시 주의사항

t-SNE의 시각화 결과는 매우 직관적으로 보이지만, 잘못 해석될 소지가 많아 다음과 같은 점에 반드시 유의해야 합니다.

- **군집의 크기는 의미가 없다**: t-SNE는 각 지역의 밀도를 확장하거나 축소하여 군집을 분리하므로, 시각화된 군집의 크기가 실제 데이터의 군집 크기나 밀도를 반영하지 않습니다.
- **군집 간의 거리는 의미가 없다**: 한 군집과 다른 군집 사이의 거리가 멀다고 해서, 그 두 군집이 다른 군집들보다 더 '이질적'이라고 해석할 수 없습니다.
- **노이즈 데이터의 군집 형성**: 무작위 노이즈 데이터도 t-SNE를 통과하면 어떤 패턴이나 군집처럼 보일 수 있으므로, 결과에 대해 항상 비판적으로 접근해야 합니다.

결론적으로 t-SNE는 데이터에 숨겨진 구조를 발견하고 시각적으로 탐색하는 데 매우 유용한 도구이지만, 그 결과를 해석할 때는 이러한 특성을 반드시 고려해야 합니다.
