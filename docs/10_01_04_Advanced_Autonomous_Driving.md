# 파트 10: AI 기반 로봇 응용 (AI-Powered Robotic Applications)

## 10.1. 자율 이동 로봇 (Autonomous Mobile Robots, AMR) & 자율주행

### 10.1.4. 자율주행 심화: 행동 계획 및 움직임 예측

**들어가며**

지금까지 다룬 인식, 위치 추정, 경로 계획이 자율주행차가 '보고', '자신의 위치를 알고', '갈 수 있는 길을 찾는' 기술이었다면, 이제는 한 단계 더 높은 수준의 '판단'과 '예측'의 영역으로 나아갈 차례입니다. 복잡한 실제 도로 상황에서 자율주행차는 주변 차량들의 의도를 파악하고, 교통 법규와 상호작용을 고려하여 "지금 무엇을 해야 하는가?"를 결정해야 합니다. 이것이 바로 **행동 계획(Behavioral Planning)**이며, 이를 위해 필수적인 기술이 다른 객체의 미래를 내다보는 **움직임 예측(Motion Prediction)**입니다.

---

**1. 행동 계획 (Behavioral Planning)**

행동 계획은 경로 계획(Path Planning)의 상위 레벨에서, 자율주행차가 수행할 **거시적인 행동을 결정**하는 과정입니다. 예를 들어, '차선 유지', '차선 변경', '좌회전', '정지' 등과 같은 고수준의 의사결정을 내립니다.

- **규칙 기반 접근 (Rule-based Approach):**
  - **유한 상태 머신 (Finite State Machine, FSM):** 행동 계획을 구현하는 고전적이고 직관적인 방법입니다. 시스템이 가질 수 있는 몇 가지 주요 **상태(State)**를 정의하고, 특정 **조건(Condition)**에 따라 한 상태에서 다른 상태로 **전이(Transition)**하도록 시스템을 설계합니다.
    - **장점:** 구조가 명확하고 예측 가능합니다.
    - **단점:** 상태와 규칙이 많아지면 매우 복잡해지고(State Explosion), 예상치 못한 상황에 대처하기 어렵습니다.
  - **행동 트리 (Behavior Tree, BT):** FSM의 단점을 보완하기 위해 게임 AI 분야에서 발전한 기술입니다. FSM보다 더 모듈화되고, 유연하며, 확장 가능한 구조로 복잡한 행동을 설계할 수 있습니다. `Sequence`, `Selector`, `Decorator` 와 같은 노드들을 조합하여 복잡한 의사결정 로직을 만듭니다.

---

**2. 움직임 예측 (Motion Prediction)**

안전한 행동을 계획하기 위해서는 내 차 주변의 다른 자동차, 보행자, 자전거 등이 앞으로 어떻게 움직일지 **불확실성 속에서** 예측해야 합니다. 움직임 예측은 인식(Perception) 시스템이 제공한 주변 객체들의 현재 상태(위치, 속도, 방향)와 과거 궤적을 바탕으로, 이들의 **가능한 미래 경로들을 확률적으로 추론**하는 기술입니다.

- **예측의 종류:**
  - **물리 기반 모델 (Physics-based Models):** 객체의 움직임을 '현재 속도와 방향을 유지할 것이다(Constant Velocity)' 또는 '현재 가속도를 유지할 것이다(Constant Acceleration)'와 같은 간단한 동역학 모델로 예측합니다. 계산이 빠르지만, 운전자의 의도를 반영하지 못해 장기 예측 정확도가 낮습니다.

  - **상호작용 고려 모델 (Interaction-aware Models):** 도로 위의 모든 행위자(agent)들이 서로에게 영향을 미친다는 점에 주목합니다. 내 차의 행동이 다른 차의 행동에 영향을 주고, 다른 차의 행동 또한 내 차에 영향을 줍니다. 주로 게임 이론(Game Theory)이나 GNN(그래프 신경망) 기반의 접근법을 사용하여 객체 간의 복잡한 상호작용을 모델링합니다.

  - **딥러닝 기반 모델 (Deep Learning-based Models):** 대규모 주행 데이터를 학습하여 인간 운전자의 복잡하고 미묘한 운전 패턴을 모델링합니다.
    - **아키텍처:** 주로 RNN, LSTM, 트랜스포머 등을 사용하여 객체의 과거 궤적(시계열 데이터)을 입력받아, **가능성 있는 여러 미래 궤적과 각 궤적의 확률**을 함께 출력합니다.
    - **장점:** 복잡한 상호작용과 다양한 시나리오를 데이터로부터 직접 학습하여 높은 예측 정확도를 보입니다.
    - **단점:** 대규모의 고품질 데이터가 필요하며, 모델의 예측 결과를 해석하기 어렵고(블랙박스 문제), 항상 안전을 보장하지는 못하므로 절대적으로 신뢰할 수 없는 한계가 있습니다. 따라서, 최종 결정 단계에서는 안전을 위한 규칙 기반 시스템이 반드시 필요합니다.

**결론**

자율주행의 '지능'은 행동 계획과 움직임 예측에서 나온다고 해도 과언이 아닙니다. FSM과 같은 규칙 기반 시스템으로 기본적인 행동의 틀을 잡고, 물리 모델과 딥러닝 기반의 예측 모델을 결합하여 주변의 불확실성에 대응함으로써, 자율주행차는 비로소 인간처럼 도로의 흐름을 읽고 사회적 규범에 맞춰 안전하게 주행할 수 있게 됩니다. 이 두 기술의 발전이 곧 더 높은 수준의 자율주행(Level 4, 5)을 실현하는 열쇠가 될 것입니다.
