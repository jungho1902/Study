# 파트 10: AI 기반 로봇 응용 (AI-Powered Robotic Applications)

## 10.1. 자율 이동 로봇 (Autonomous Mobile Robots, AMR) & 자율주행

### 10.1.4. 자율주행 심화: 행동 계획 및 움직임 예측

**들어가며**

지금까지 다룬 인식, 위치 추정, 경로 계획이 자율주행차가 '보고', '자신의 위치를 알고', '갈 수 있는 길을 찾는' 기술이었다면, 이제는 한 단계 더 높은 수준의 '판단'과 '예측'의 영역으로 나아갈 차례입니다. 복잡한 실제 도로 상황에서 자율주행차는 주변 차량들의 의도를 파악하고, 교통 법규와 상호작용을 고려하여 "지금 무엇을 해야 하는가?"를 결정해야 합니다. 이것이 바로 **행동 계획(Behavioral Planning)**이며, 이를 위해 필수적인 기술이 다른 객체의 미래를 내다보는 **움직임 예측(Motion Prediction)**입니다.

---

**1. 행동 계획 (Behavioral Planning)**

행동 계획은 경로 계획(Path Planning)의 상위 레벨에서, 자율주행차가 수행할 **거시적인 행동을 결정**하는 과정입니다. 예를 들어, '차선 유지', '차선 변경', '좌회전', '정지' 등과 같은 고수준의 의사결정을 내립니다.

- **유한 상태 머신 (Finite State Machine, FSM):**
  - **개념:** 행동 계획을 구현하는 고전적이고 직관적인 방법입니다. 시스템이 가질 수 있는 몇 가지 주요 **상태(State)**를 정의하고, 특정 **조건(Condition) 또는 이벤트(Event)**에 따라 한 상태에서 다른 상태로 **전이(Transition)**하도록 시스템을 설계합니다.
  - **자율주행 예시:**
    - **상태(States):** `차선 유지(Lane Keeping)`, `좌측 차선 변경 준비(Prepare Lane Change Left)`, `차선 변경 중(Changing Lane)`, `우측 차선 변경 준비(Prepare Lane Change Right)` 등.
    - **전이 조건(Transitions):**
      - `차선 유지` 상태에서, (만약 전방에 저속 차량이 있고) + (좌측 차선이 비어 있다면) -> `좌측 차선 변경 준비` 상태로 전이.
      - `좌측 차선 변경 준비` 상태에서, (핸들 조작이 시작되면) -> `차선 변경 중` 상태로 전이.
      - `차선 변경 중` 상태에서, (차선 중앙에 안착하면) -> `차선 유지` 상태로 복귀.
  - **장점:** 구조가 명확하여 이해하고 디버깅하기 쉽습니다. 예측 가능한 상황에서 안정적으로 동작합니다.
  - **단점:** 상태와 전이 규칙을 모두 수동으로 설계해야 하므로, 복잡하고 예상치 못한 상황에 대처하기 어렵습니다. 상태의 수가 많아지면 관리가 매우 복잡해집니다.

---

**2. 움직임 예측 (Motion Prediction)**

안전한 행동을 계획하기 위해서는 내 차 주변의 다른 자동차, 보행자, 자전거 등이 앞으로 어떻게 움직일지 예측해야 합니다. 움직임 예측은 인식(Perception) 시스템이 제공한 주변 객체들의 현재 상태(위치, 속도, 방향)와 과거 궤적을 바탕으로, 이들의 미래 경로를 확률적으로 추론하는 기술입니다.

- **예측의 종류:**
  - **물리 기반 모델 (Physics-based Models):**
    - **개념:** 객체의 움직임을 동역학 법칙에 따라 예측합니다. 예를 들어, '현재 속도와 방향을 유지할 것이다(Constant Velocity)' 또는 '현재 가속도를 유지할 것이다(Constant Acceleration)'와 같은 간단한 모델을 사용합니다.
    - **장점:** 계산이 매우 빠르고 간단합니다. 단기 예측(1~2초)에서는 합리적인 성능을 보입니다.
    - **단점:** 다른 차량과의 상호작용이나 운전자의 의도를 전혀 반영하지 못하므로, 장기 예측이나 복잡한 시나리오(예: 교차로, 합류 지점)에서는 정확도가 급격히 떨어집니다.

  - **상호작용 고려 모델 (Interaction-aware Models):**
    - **개념:** 도로 위의 모든 행위자(agent)들이 서로에게 영향을 미친다는 점에 주목합니다. 내 차의 행동이 다른 차의 행동에 영향을 주고, 다른 차의 행동 또한 내 차에 영향을 줍니다.
    - **기술:** 주로 게임 이론(Game Theory)이나 딥러닝 기반의 접근법을 사용합니다. 예를 들어, 여러 차량이 동시에 진입하는 교차로에서 각 차량이 선택할 수 있는 행동(직진, 좌회전 등)에 대한 비용(cost)을 계산하고, 모든 차량의 비용을 최소화하는 방향으로 각자의 경로를 예측합니다.

  - **딥러닝 기반 모델 (Deep Learning-based Models):**
    - **개념:** 대규모 주행 데이터를 학습하여, 인간 운전자의 복잡하고 미묘한 운전 패턴을 모델링합니다.
    - **아키텍처:** 주로 순환 신경망(RNN, LSTM)이나 트랜스포머(Transformer)를 사용하여 객체의 과거 궤적(시계열 데이터)을 입력받아 미래 궤적을 예측합니다. 최근에는 그래프 신경망(GNN)을 이용해 여러 객체 간의 상호작용을 그래프 형태로 모델링하여 예측 정확도를 높이는 연구가 활발히 진행되고 있습니다.
    - **장점:** 복잡한 상호작용과 다양한 시나리오를 데이터로부터 직접 학습하여 높은 예측 정확도를 보입니다.
    - **단점:** 대규모의 고품질 데이터가 필요하며, 모델의 예측 결과를 해석하기 어려울 수 있습니다(블랙박스 문제).

**결론**

자율주행의 '지능'은 행동 계획과 움직임 예측에서 나온다고 해도 과언이 아닙니다. FSM과 같은 규칙 기반 시스템으로 기본적인 행동의 틀을 잡고, 물리 모델과 딥러닝 기반의 예측 모델을 결합하여 주변의 불확실성에 대응함으로써, 자율주행차는 비로소 인간처럼 도로의 흐름을 읽고 사회적 규범에 맞춰 안전하게 주행할 수 있게 됩니다. 이 두 기술의 발전이 곧 더 높은 수준의 자율주행(Level 4, 5)을 실현하는 열쇠가 될 것입니다.
