# 6.4. CI/CD/CT for ML

MLOps의 핵심 목표는 머신러닝 모델의 생명주기를 자동화하는 것이며, 이는 CI/CD/CT라는 세 가지 핵심 개념을 통해 달성됩니다. 이는 기존 소프트웨어 개발의 CI/CD를 머신러닝의 특성에 맞게 확장한 것입니다.

---

### 1. CI (Continuous Integration, 지속적 통합)

지속적 통합은 코드 변경 사항을 중앙 리포지토리(예: Git)에 정기적으로 통합하고, 자동으로 빌드 및 테스트하는 관행입니다. ML에서의 CI는 코드뿐만 아니라 데이터와 모델의 유효성 검사까지 포함합니다.

#### ML에서의 CI 파이프라인 주요 단계
1.  **코드 커밋 (Code Commit):** 개발자가 코드를 변경하고 Git 리포지토리에 푸시합니다.
2.  **정적 코드 분석 (Static Code Analysis):** 코드 스타일 가이드(Linting), 잠재적 버그 등을 자동으로 검사합니다.
3.  **단위 테스트 (Unit Testing):** 개별 함수나 컴포넌트가 의도대로 작동하는지 검증합니다.
4.  **데이터 유효성 검사 (Data Validation):**
    -   새로운 데이터의 스키마(형식, 타입 등)가 기존 데이터와 일치하는지 확인합니다.
    -   데이터의 통계적 분포를 분석하여 예상치 못한 변화가 없는지 검사합니다.
5.  **모델 유효성 검사 (Model Validation):**
    -   재학습된 모델의 성능이 기존 프로덕션 모델보다 저하되지 않았는지, 혹은 설정된 최소 성능 기준을 충족하는지 평가합니다.
    -   모델의 예측 편향성(Bias) 등을 검사하여 공정성 기준을 만족하는지 확인합니다.
6.  **ML 파이프라인 컴포넌트 빌드:** 테스트를 통과한 코드와 컴포넌트를 패키징하여 배포할 수 있는 상태로 만듭니다. (예: Docker 이미지 빌드)

-   **핵심 목표:** 코드, 데이터, 모델의 변경 사항을 신속하게 통합하고, 파이프라인의 각 단계가 유기적으로 잘 작동하는지 조기에 검증하는 것입니다.

---

### 2. CD (Continuous Delivery/Deployment, 지속적 제공/배포)

지속적 제공/배포는 CI 단계를 통과한 결과물(ML 파이프라인 또는 모델)을 자동으로 프로덕션 환경에 배포하는 프로세스입니다.

-   **지속적 제공 (Continuous Delivery):** CI를 통과한 모델과 파이프라인을 언제든지 배포할 수 있는 상태로 준비해두는 것을 의미합니다. 실제 프로덕션 배포는 수동 승인(예: 버튼 클릭)을 통해 제어됩니다. 이는 비즈니스적으로 민감한 모델을 배포하기 전에 최종 검토 단계를 두고 싶을 때 유용합니다.

-   **지속적 배포 (Continuous Deployment):** 지속적 제공에서 한 단계 더 나아가, CI/CD의 모든 단계를 통과하면 **자동으로** 프로덕션 환경까지 배포하는 것을 의미합니다. 사람의 개입이 최소화되어 배포 속도를 극대화할 수 있습니다.

#### ML에서의 CD 파이프라인 주요 단계
1.  **CI 파이프라인 실행:** 위의 CI 파이프라인이 성공적으로 완료됩니다.
2.  **모델을 모델 레지스트리에 등록:** 검증된 모델을 버전과 함께 모델 레지스트리에 저장합니다.
3.  **배포 패키징:** 모델을 서빙할 수 있도록 Docker 컨테이너 등으로 패키징합니다.
4.  **스테이징 환경 배포:** 실제 프로덕션 환경과 유사한 스테이징 환경에 모델을 배포하여 최종 통합 테스트를 수행합니다.
5.  **프로덕션 환경 배포:** 스테이징 테스트를 통과하면, 카나리(Canary)나 블루/그린(Blue/Green) 같은 점진적인 배포 전략을 사용하여 안전하게 프로덕션 환경에 모델을 배포합니다.

---

### 3. CT (Continuous Training, 지속적 학습)

지속적 학습은 MLOps 고유의 개념으로, 새로운 데이터가 유입되거나 프로덕션 모델의 성능이 저하될 때 **자동으로 모델을 재학습**하는 프로세스입니다.

#### 왜 CT가 필요한가?
세상은 계속 변하고, 이는 데이터의 패턴도 변한다는 것을 의미합니다.
-   **데이터 드리프트 (Data Drift):** 시간이 지남에 따라 입력 데이터의 통계적 분포가 변하는 현상입니다. (예: 계절 변화에 따른 사용자 행동 패턴 변화)
-   **컨셉 드리프트 (Concept Drift):** 입력 데이터와 타겟 변수(정답) 간의 관계 자체가 변하는 현상입니다. (예: 새로운 경쟁자 등장으로 인한 고객 이탈 요인 변화)

이러한 드리프트가 발생하면 모델의 예측 성능은 점차 저하(Model Decay)되므로, 주기적인 재학습이 필수적입니다.

#### CT 파이프라인의 작동 방식
1.  **모델 성능 모니터링:** 프로덕션 환경에서 모델의 예측 성능과 입력 데이터의 분포를 지속적으로 모니터링합니다.
2.  **트리거 (Trigger) 설정:** 재학습을 시작할 조건을 설정합니다.
    -   **스케줄 기반:** 매주, 매월 등 정해진 주기로 재학습을 실행합니다.
    -   **성능 저하 기반:** 모델의 정확도가 특정 임계값 이하로 떨어지면 재학습을 실행합니다.
    -   **새로운 데이터 유입 기반:** 새로운 데이터가 일정량 이상 수집되면 재학습을 실행합니다.
3.  **자동 재학습:** 트리거가 활성화되면, 전체 MLOps 파이프라인(데이터 처리 -> 모델 훈련 -> 모델 평가)이 자동으로 실행됩니다.
4.  **모델 업데이트:** 재학습된 새 모델의 성능이 기존 모델보다 우수하면, CD 파이프라인을 통해 프로덕션 모델이 자동으로 업데이트됩니다.

**CI/CD/CT**는 서로 맞물려 돌아가는 하나의 거대한 루프를 형성하여, 머신러닝 시스템이 변화에 신속하게 적응하고 항상 최적의 성능을 유지하도록 돕습니다.
